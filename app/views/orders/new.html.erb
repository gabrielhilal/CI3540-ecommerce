<h1>Check out</h1>
<% unless current_cart.line_items.nil? %>
<table>
  <tr>
    <th>Item</th>
    <th>Quantity</th>
    <th>Price</th>
    <th>Total</th>
  </tr>
<% @items.each do |item| %>
  <tr>
    <td><%= item.product.title %></td>
    <td><%= item.quantity %></td>
    <td><%= number_to_currency item.product.price, unit: "&pound;" %></td>
    <td><%= number_to_currency (item.quantity * item.product.price), unit: "&pound;" %></td>
  </tr>
<% end %>
  <tr>
    <td></td>
    <td><strong><%= @items.map do |i| i.quantity end.sum %></strong></td>
    <td></td>
    <% total = @items.map do |i| i.quantity * i.product.price.to_f end.sum %>
    <td><strong><%= number_to_currency total, unit: "&pound;" %></strong></td>
  </tr>
</table>
<% end %>
<%= form_for(@order) do |f| %>
    <% #display error messages if form can't be submitted. %>
    <% #please see shared partial "error_messages.html.erb" for details. %>
    <% #please also refer to the model Categories for validations that may impede submission %>
    <%= render 'shared/error_messages', :object => f.object %>

<h3>Payment</h3>

  <div class="field">
    <%= f.label :card_type %><br />
    <%= f.select :card_type, Order::CARDS, prompt: 'Select a payment method' %>
  </div>
  <div class="field">
    <%= f.label :card_number %><br />
    <%= f.text_field :card_number %>
  </div>
  <div class="field">
    <%= f.label :card_date %><br />
    <%= f.text_field :card_date %>
  </div>
  <div class="field">
    <%= f.label :card_cvc %><br />
    <%= f.text_field :card_cvc %>
  </div>
  <div class="actions">
    <%= f.submit 'Place Order' %>
  </div>
<% end %>
